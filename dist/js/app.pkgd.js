!function e(t,n,a){function s(i,r){if(!n[i]){if(!t[i]){var c="function"==typeof require&&require;if(!r&&c)return c(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return s(n?n:e)},u,u.exports,e,t,n,a)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<a.length;i++)s(a[i]);return s}({1:[function(e,t,n){"use strict";var a=e("./modules/about.js"),s=e("../jsx/Components.jsx");window.log=function(e){console.log(e)},window.router=e("./modules/router.js"),window.util=e("./modules/util.js"),window.css3=e("./modules/css3.js"),window.phpScript="./libs/item.php",window.comp={index:ReactDOM.render(React.createElement(s.Index,{json:"./libs/item.php?page={page}"}),document.getElementById("itemIndex")),view:ReactDOM.render(React.createElement(s.View,{json:"./libs/item.php?type=viewIndex"}),document.getElementById("popup")),about:new a},window["goto"]={index:function(e){e=e?parseInt(e):1,comp.index.load(e),comp.view.opened&&comp.view.close()},view:function(e){comp.view.open(e,comp.index.ready?!0:!1)},about:function(){comp.about.open(comp.index.ready?!0:!1)}},router.addRoute("",goto.index),router.addRoute("/",goto.index),router.addRoute("/page/:page",goto.index),router.addRoute("/view/:srl",goto.view),router.addRoute("/About",goto.about),util.touch()&&jQuery("html").addClass("mode-touch"),router.start()},{"../jsx/Components.jsx":6,"./modules/about.js":2,"./modules/css3.js":3,"./modules/router.js":4,"./modules/util.js":5}],2:[function(e,t,n){"use strict";function a(){var e=this,t=$("#about"),n="./pages/about.html";this.opened=!1,this.open=function(a){function s(){t.find("[data-act=close]").on("click",function(){e.close()})}this.opened=!0,a?t.load(n,function(){t.show(),setTimeout(function(){t.addClass("show"),css3.transitionEnd(t,function(){$("html").addClass("mode-popup"),s()})},50)}):($("html").addClass("mode-popup"),t.show().addClass("show"),t.load(n,function(){s()}))},this.close=function(){if(this.opened=!1,$("html").removeClass("mode-popup"),t.removeClass("show"),t.find("[data-act=close]").off("click"),css3.transitionEnd(t,function(){t.empty().hide()}),comp.index){var e=comp.index.state.page,n=$("#itemIndex ul li");n.length&&router.oneStop(),location.hash=e>1?"#/page/"+e:"#/"}}}t.exports=a},{}],3:[function(e,t,n){"use strict";function a(){this.eventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},this.isSupport=function(){var e=document.createElement("div");for(var t in this.eventNames)if(void 0!==e.style[t])return this.eventNames[t];return e=null,!1},this.transitionEnd=function(e,t){this.isSupport()&&t&&$(e).one(this.isSupport(),t)}}t.exports=new a},{}],4:[function(e,t,n){"use strict";var a=function(){function e(e,t){i.push({parts:e.split("/"),handler:t})}function t(e){window.location.hash=e}function n(){r=!0}function a(){r=!1}function s(){r=!0,c=!0}function o(){if(r)return c&&(c=!1,r=!1),!1;for(var e=window.location.hash.substr(1),t=e.split("/"),n=t.length,a=0;a<i.length;a++){var s=i[a];if(s.parts.length===n){for(var o=[],l=0;n>l;l++)if(":"===s.parts[l].substr(0,1))o.push(t[l]);else if(s.parts[l]!==t[l])break;if(l===n)return void s.handler.apply(void 0,o)}}}var i=[],r=!1,c=!1;return window.onhashchange=o,{addRoute:e,load:t,start:o,stop:n,resume:a,oneStop:s}};t.exports=a()},{}],5:[function(e,t,n){"use strict";function a(){this.touch=function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}}t.exports=new a},{}],6:[function(e,t,n){"use strict";var a={};a.Index=React.createClass({displayName:"Index",url:null,method:"overwrite",ready:!1,getInitialState:function(){return{items:[],page:1,showMoreButton:!0}},componentDidMount:function(){this.url=this.props.json},load:function(e){var t=this;this.ready=!0,e=parseInt(e),this.setState({page:parseInt(e)}),$.get(this.url.replace("{page}",e?e:1),function(e){e=JSON.parse(e);t.update(e.result);t.method="overwrite",e.next||t.setState({showMoreButton:!1}),t.refs.more.buttonControl(!1)})},update:function(e){if(!e.length)return!1;var t="add"==this.method?this.state.items.concat(e):e;return this.setState({items:t}),!0},render:function(){return React.createElement("div",null,React.createElement(s,{items:this.state.items}),React.createElement(i,{ref:"more",show:this.state.showMoreButton,dir:"next"}))}});var s=React.createClass({displayName:"IndexItems",render:function(){var e=function(e,t){return React.createElement(o,{key:t},e)};return React.createElement("ul",{ref:"list"},this.props.items.map(e))}}),o=React.createClass({displayName:"IndexItem",onClick:function(e){return comp.view.opened?!1:!0},render:function(){var e=this.props.children;return React.createElement("li",{key:"item-"+e.srl},React.createElement("a",{href:"#/view/"+e.srl,onClick:this.onClick},React.createElement(r,{src:e.img,alt:e.title})))}}),i=React.createClass({displayName:"IndexMore",getInitialState:function(){return{class_button:""}},moreData:function(e){this.buttonControl(!0),comp.index.method="add",location.hash="/page/"+("prev"==this.props.dir?comp.index.state.page-1:comp.index.state.page+1)},buttonControl:function(e){e?this.setState({class_button:"rotate"}):this.setState({class_button:""})},render:function(){var e=null;return this.props.show&&(e=React.createElement("button",{type:"button",className:this.state.class_button,title:"more load images",key:"more",onClick:this.moreData},React.createElement("i",null))),React.createElement("nav",{className:"more-data"},e)}}),r=React.createClass({displayName:"ImageLoader",figure:null,img:new Image,getInitialState:function(){return{class_loading:"loading",class_image:"image",class_error:"error"}},componentDidMount:function(){var e=this,t=new Image;this.figure=ReactDOM.findDOMNode(this.refs.figure),t.onload=function(){t=null,setTimeout(function(){e.setState({class_loading:"",class_image:"image show"})},50)},t.onerror=function(){t=null,e.setState({class_loading:"",class_error:"error show"})},t.src=this.props.src},render:function(){var e={backgroundImage:this.props.src?"url("+this.props.src+")":""};return React.createElement("figure",{ref:"figure",title:this.props.title},React.createElement("span",{ref:"image",className:this.state.class_image,style:e}),React.createElement("span",{ref:"error",className:this.state.class_error}),React.createElement("span",{ref:"loading",className:this.state.class_loading}))}});a.View=React.createClass({displayName:"View",opened:!1,scrollTop:0,getInitialState:function(){return{parentClassName:"",srl:null,slideSwitch:!1,navDirection:{prev:"",next:""}}},componentDidMount:function(){},open:function(e,t){var n=this;this.opened=!0,this.scrollTop=document.body.scrollTop,t?(this.setState({parentClassName:"show"},function(){setTimeout(function(){n.setState({parentClassName:"show animate"})},30)}),css3.transitionEnd(ReactDOM.findDOMNode(this.refs.wrap),function(t){n.action(t.target,e)})):(n.setState({parentClassName:"show animate"}),n.action(ReactDOM.findDOMNode(this.refs.wrap),e)),$("html").addClass("mode-popup")},action:function(e,t){this.setState({srl:t}),this.refs.slider.open(),this.keyboardEvent(!0)},close:function(){var e=this;if(this.opened=!1,this.setState({parentClassName:"show"}),this.keyboardEvent(!1),css3.transitionEnd(ReactDOM.findDOMNode(this.refs.wrap),function(t){e.refs.slider.swipeEvent&&(e.refs.slider.swipeEvent.kill(),e.refs.slider.swipeEvent=null),e.setState({parentClassName:""});var n=$(ReactDOM.findDOMNode(e.refs.slider.refs.swipeWrap));n.find(".show").removeClass("show"),e.refs.help.opened&&e.refs.help.close(),document.body.scrollTop=e.scrollTop}),comp.index){var t=comp.index.state.page,n=ReactDOM.findDOMNode(comp.index).getElementsByTagName("UL")[0].children.length;n&&router.oneStop(),location.hash=t>1?"#/page/"+t:"#/"}$("html").removeClass("mode-popup")},move:function(e){switch(e.currentTarget.getAttribute("data-dir")){case"prev":this.refs.slider.prev();break;case"next":this.refs.slider.next()}},navigationControl:function(e){this.setState({navDirection:{prev:e.prev?"show":"",next:e.next?"show":""}})},keyboardEvent:function(e){var t=this;e?$(window).on("keyup.view",function(e){37==e.keyCode?t.refs.slider.next():39==e.keyCode?t.refs.slider.prev():27==e.keyCode&&t.close()}):$(window).off("keyup.view")},openHelp:function(){this.refs.help.opened?this.refs.help.close():this.refs.help.open()},render:function(){var e;return util.touch()||(e=React.createElement("nav",{className:"control-direction"},React.createElement("button",{type:"button",onClick:this.move,"data-dir":"next",title:"next image",className:"prev "+this.state.navDirection.next},React.createElement("i",{className:"sp-ico ico-arrow-left"})),React.createElement("button",{type:"button",onClick:this.move,"data-dir":"prev",title:"prev image",className:"next "+this.state.navDirection.prev},React.createElement("i",{className:"sp-ico ico-arrow-right"})))),React.createElement("article",{ref:"wrap",className:"pop-view "+this.state.parentClassName},React.createElement(l,{ref:"slider",srl:this.state.srl,json:this.props.json,navControl:this.navigationControl}),React.createElement("nav",{className:"control-top"},React.createElement("button",{type:"button",ref:"help",title:"help",onClick:this.openHelp},React.createElement("i",{className:"sp-ico ico-help"})),React.createElement("button",{type:"button",onClick:this.close,ref:"close",title:"close"},React.createElement("i",{className:"btn-close"}))),e,React.createElement(c,{ref:"help"}))}});var c=React.createClass({displayName:"KeyboardHelp",opened:!1,getInitialState:function(){return{classStr:""}},open:function(){var e=this;this.opened=!0,$(ReactDOM.findDOMNode(this)).show(),setTimeout(function(){e.setState({classStr:"show"})},30)},close:function(){var e=this;this.opened=!1,this.setState({classStr:""}),setTimeout(function(){$(ReactDOM.findDOMNode(e)).hide()},280)},render:function(){return React.createElement("section",{className:"help "+this.state.classStr},React.createElement("h1",null,"Keyboard guide"),React.createElement("div",{className:"bd"},React.createElement("dl",null,React.createElement("dt",null,React.createElement("span",null,"ESC")),React.createElement("dd",null,"Close view")),React.createElement("dl",null,React.createElement("dt",null,React.createElement("span",null,"LEFT")),React.createElement("dd",null,"Prev Slide")),React.createElement("dl",null,React.createElement("dt",null,React.createElement("span",null,"RIGHT")),React.createElement("dd",null,"Next Slide"))),React.createElement("button",{type:"button",className:"close",title:"close",onClick:this.close},React.createElement("i",null,"close")))}}),l=React.createClass({displayName:"Slider",ready:!1,swipeEvent:null,total:0,getInitialState:function(){return{data:[]}},componentDidMount:function(){var e=this;$.get(this.props.json,function(t){var n=JSON.parse(t).result;e.total=n.length,e.setState({data:n}),e.ready=!0;var a=e.refs["item-"+e.props.srl],s=$(ReactDOM.findDOMNode(a));comp.view.opened&&e.initSwipe(s)})},checkNavigation:function(){var e=this.swipeEvent.getPos(),t={prev:!0,next:!0};0==e?t.prev=!1:this.total-1<=e&&(t.next=!1),this.props.navControl(t)},initSwipe:function(e){var t=this;this.swipeEvent=Swipe(ReactDOM.findDOMNode(this),{startSlide:e.index(),continuous:!1,callback:function(e,n){var a=$(n).children(".img");"none"==a.css("backgroundImage")?t.imageLoad(n.childNodes[0]):a.hasClass("show")||a.addClass("show"),t.changeUrl(parseInt(n.getAttribute("data-srl"))),t.checkNavigation()},transitionEnd:function(e,t){}});var n=e.children(".img");n.length&&(this.imageLoad(n.get(0)),t.checkNavigation())},getItem:function(e){return this.refs["item-"+e]},imageLoad:function(e){var t=e.getAttribute("data-src"),n=new Image;n.onload=function(){n=null;var a=$(e),s=parseInt(a.parent().attr("data-srl"));a.parent().removeClass("loading"),a.css("background-image","url('"+t+"')").removeClass("not-animation").addClass("show"),$.get(phpScript+"?type=updateHit&srl="+s,function(e){})},n.onerror=function(){n=null},n.src=t},open:function(){if(this.ready){var e=this.getItem(this.props.srl),t=$(ReactDOM.findDOMNode(e));t.children().removeClass("show").addClass("not-animation"),this.initSwipe(t)}},prev:function(){this.swipeEvent.prev()},next:function(){this.swipeEvent.next()},changeUrl:function(e){router.oneStop(),location.hash="/view/"+e},render:function(){var e=this.state.data.map(function(e,t){return React.createElement("div",{ref:"item-"+e.srl,"data-srl":e.srl,key:"srl-"+e.srl,className:"loading"},React.createElement("div",{"data-src":e.img,title:e.title,className:"img"}),React.createElement("span",{className:"log"},"index:"+t+", srl:"+e.srl))});return React.createElement("div",{ref:"slider",className:"swipe"},React.createElement("div",{ref:"swipeWrap",className:"swipe-wrap"},e))}});t.exports=a},{}]},{},[1]);
//# sourceMappingURL=maps/app.pkgd.js.map
